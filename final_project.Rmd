
---
title: "ADD YOUR TITLE HERE"
author: "Nicole Tresvalles & Karen Galvan"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    fig_caption: yes
    theme: lumen
    toc: yes
    toc_depth: 2
    df_print: kable
    toc_float:
      collapsed: no
    number_sections: yes
---

```{r, include=FALSE}
# Do not edit this code block/chunk (unless you know what you're doing)
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning = FALSE, fig.width = 16/2.5, fig.height = 9/2.5)
```


```{r}
# Make sure you have all these packages installed:
library(ggplot2)
library(dplyr)
library(readr)
library(moderndive)
library(knitr)

# Add any additionally needed packages here:

```


```{r, out.width="100%"}
# Change the URL here to point a relevant image:
include_graphics("https://images.squarespace-cdn.com/content/v1/5661b263e4b0830bdc162128/1531234150802-7M3VMHK28W1T2DF5POZN/5901c94f2600001700c47fbc.jpeg")
```



***



# Introduction 

1. Research Question: What are the trends in Hass Avocado sales in different regions of the US and how does it change over time? 
1. Context: According to the USDA, the United States has tripled their per capita consumption of avocados  since the early 2000’s, with about 95% being Hass avocados. Along with its taste, size, and longer shelf life, Hass avocados have had greater growing yield in certain regions^[Global hass avocado market: 2022 - 27: Industry share, size, growth. Global Hass Avocado Market | 2022 - 27 | Industry Share, Size, Growth - Mordor Intelligence. (n.d.). Retrieved March 9, 2022, from (https://www.mordorintelligence.com/industry-reports/global-hass-avocado-market#:~:text=In%20the%20United%20States%2C%20per,many%20countries%20across%20the%20globe).]. The following dataset’s information directly comes from retailers describing the price of avocados and the amount they sell. 
1. In the case of this dataset, the difference between organic and conventional is the amount of detectable levels of pesticides residue. 




***

# Exploratory data analysis

```{r}
# Change this code to load your CSV file from the web and do any data cleaning here:
avocado_data <- read_csv("avocados.csv") %>% 
  # Select only the needed variables:
  select(-XLarge.Bags) %>% 
  # Drop rows with missing data for crashes
  filter(region == "Midsouth"|region == "NorthernNewEngland"|region == "Northeast"|
           region == "Southeast"|region == "West" | region == "Plains" ) %>% 
  select(-large_hass_sold, -small_hass_sold, -xlarage_hass_sold, -Total.Bags, -Small.Bags, -Large.Bags)

avocado_data_2016 <- avocado_data %>% 
  filter(year == 2016)
```


## Describe data

Give people a sense for your data by describing:

1. What each observation in each row corresponds to: Each observation corresponds to the average price of a single avocado being sold in a given date and region. 
1. Sample size: Rhere’s a total of 18,259 observations included in the dataset.
1. Outcome variable $y$: the average price of an avocado 
1. Numerical explanatory variable $x_1$: total volume of avocados sold
1. Categorical explanatory variable $x_2$ and what the $k$ levels/categories are: Date and year of observation, Region of the observation, type of avocado (organic/conventional), average
1. Display a snapshot of five randomly chosen rows of data


```{r}
# Change this code to show a random sample of 5 rows of the data:
avocado_data %>% 
  sample_n(5)
```


## Summary statistics

```{r}
# Insert code to output a table of summary statistics:
avocado_model <- lm(AveragePrice ~ year, data = avocado_data)
get_regression_table(avocado_model)
```


```{r}
# Insert code to output a table of summary statistics, but this time
# split by the different levels of the categorical variable:
avocado_mod_categorical <- lm(AveragePrice ~ region, data = avocado_data)
get_regression_table(avocado_mod_categorical)
```


## Data visualizations

```{r, fig.cap = "Figure 1: Types of Avocado Average Prices in 2016", fig.align = "center"}
# Insert code to visualize the distribution of outcome variable:
ggplot(avocado_data_2016, aes(x = factor(type), y = AveragePrice)) +
  geom_boxplot() +
  labs(x = "Type of Avocado", 
       y = "Average Price", 
       title = "Average Prices of Avocados in 2016 (by type)")
```

Describe any key insight from Figure 1 here.
The average median price for organic avocados seems to be much higher than the averager median price for conventional avocados. 

```{r, fig.cap = "Figure 2: Avocado Average Prices in 2016", fig.align = "center"}
# Insert code to visualize the relationship between outcome variable and numerical explanatory variable:
ggplot(avocado_data_2016, aes(y = AveragePrice, x = Date, color = type)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) + 
  labs(x = "Month", 
       y = "Average Price", 
       title = "Average Prices of Avocados in 2016 (by region)") +
  facet_wrap(~region)
```

Describe any key insight from Figure 2 here.
Consistently across all regions, the average price of an organic avocado is higher than its conventional counter part. The Northeast and Plains region seems to have stronger correlation coefficients than their counterpart.

```{r, fig.cap = "Figure 3: Total Volume of Avocado Sold in 2016", fig.align = "center"}
# Insert code to visualize the relationship between outcome variable and categorical explanatory variable:
ggplot(avocado_data_2016, aes(y = Total.Volume, x = region)) +
  geom_boxplot() +
  labs(x = "Region", 
       y = "Total Volume", 
       title = "Total Volume of Avocados Sold in 2016 (by region)") +
  scale_y_continuous(labels = scales::comma)
```

Describe any key insight from Figure 3 here.

```{r, fig.cap = "Figure 4: Average Price of Total Volume Sold in 2016 (Interaction)", fig.align = "center"}
# Insert code to visualize interaction model:
ggplot(avocado_data_2016, aes(x = Total.Volume, y = AveragePrice, color = region)) +
  geom_point() +
  labs(x = "Total Volume", y = "Average Price", color = "Region", 
       title = "Average Price of Total Volume of Avocados Sold in 2016 (by region)") +
  geom_smooth(method = "lm", se = FALSE) +
  scale_x_continuous(labels = scales::comma)

# Fit regression model:
avocado_model_interaction <- lm(AveragePrice ~ Total.Volume * region, data = avocado_data_2016)

# Get regression table:
get_regression_table(avocado_model_interaction)

```

Describe any key insight from Figure 4 here.

```{r, fig.cap = "Figure 5: Average Price of Total Volume Sold in 2016 (Parallel)", fig.align = "center"}
# Insert code to visualize parallel slopes model:
ggplot(avocado_data_2016, aes(x = Total.Volume, y = AveragePrice, color = region)) +
  geom_point() +
  labs(x = "Total Volume", y = "Average Price", color = "Region", 
       title = "Average Price of Total Volume of Avocados Sold in 2016 (by region)") +
  geom_parallel_slopes(se = FALSE) +
  scale_x_continuous(labels = scales::comma)
  
# Fit regression model:
avocado_model_parallel_slopes <- lm(AveragePrice ~ Total.Volume + region, data = avocado_data_2016)
# Get regression table:
get_regression_table(avocado_model_parallel_slopes)  
```

Describe any key insight from Figure 5 here.

## Initial conclusions

Write:

- What insight you would tell your grandmother
- Your initial model selection choice, interaction or parallel slopes model, and why.

From the initial glance at the visualizations, we conclude that organic avocados tend to consistently cost more on average across all the regions we highlighted. Furthermore, as total volume of avocados sold increases, the average price gets less, which might be because of wholesale. As for the model selection, it seems like the parallel slopes model would be the best choice because it is easier to interpret. It has a lot less variation compared to the interaction model that has different intercepts and different slopes. Furthermore, the interaction model has additional complexity which can be seen by the additional rows in the interaction regression table.  




***



# Multiple linear regression

## Methods


## Model Results


## Interpreting the regression table


## Inference for multiple regression


## Residual Analysis



***



# Discussion 

## Conclusions


## Limitations


## Further questions



***



# Honor code

## Project peers

Name all people who contributed in any way to this project (other than groupmates, Prof. Kim, and Beth Brown): Karen Galvan & Nicole Tresvalles

## Code sources

List any sources for coding matters you consulted in bullet point form (other than SDS 220 materials). For example, you can change the following list:

1. [Labeling legends in ggplot2](https://www.datanovia.com/en/blog/ggplot-legend-title-position-and-labels/)
1. [Randomly sampling rows with dplyr](https://www.datasciencemadesimple.com/select-random-samples-r-dplyr-sample_n-sample_frac/#:~:text=Dplyr%20package%20in%20R%20is,the%20random%20N%25%20of%20rows.)

## Citations and References

Ensure all in-text citations (if any) show up here using RMarkdown footnotes as seen in the Introduction:
